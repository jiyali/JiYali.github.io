<!DOCTYPE html>












  


<html class="theme-next muse use-motion" lang="zh-CN">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script>
<link href="//cdn.bootcss.com/pace/1.0.2/themes/pink/pace-theme-flash.css" rel="stylesheet">




  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link rel="stylesheet" href="/lib/pace/pace-theme-minimal.min.css?v=1.0.2">





















<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2">

<link rel="stylesheet" href="/css/main.css?v=7.1.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.1.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=7.1.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=7.1.0">


  <link rel="mask-icon" href="/images/logo.svg?v=7.1.0" color="#222">







<script id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '7.1.0',
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false,"dimmer":false},
    back2top: true,
    back2top_sidebar: false,
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="摘要本文展示了一种自动生成图像标注的新方法：直接地从图像标注数据集中学习的视觉检测器和语言模型。我们使用的是多示例学习去训练在标题中常见词的视觉检测器，这些常见词包括很多不同的词性包括名词、动词和形容词。单词检测器的输出用作最大熵语言模型的条件输入。这个语言模型从一组超过400,000图像标注中学习，来捕捉单词用法的统计量。我们通过使用句子级的特征和多模态相似性模型来对标题候选者的重新排序，从而获">
<meta property="og:type" content="article">
<meta property="og:title" content="论文笔记-From Captions to Visual Concepts and Back">
<meta property="og:url" content="http://yoursite.com/2019/02/25/论文笔记-From-Captions-to-Visual-Concepts-and-Back/index.html">
<meta property="og:site_name" content="Coding With Yali">
<meta property="og:description" content="摘要本文展示了一种自动生成图像标注的新方法：直接地从图像标注数据集中学习的视觉检测器和语言模型。我们使用的是多示例学习去训练在标题中常见词的视觉检测器，这些常见词包括很多不同的词性包括名词、动词和形容词。单词检测器的输出用作最大熵语言模型的条件输入。这个语言模型从一组超过400,000图像标注中学习，来捕捉单词用法的统计量。我们通过使用句子级的特征和多模态相似性模型来对标题候选者的重新排序，从而获">
<meta property="og:locale" content="zh-CN">
<meta property="og:updated_time" content="2019-04-12T10:28:22.237Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="论文笔记-From Captions to Visual Concepts and Back">
<meta name="twitter:description" content="摘要本文展示了一种自动生成图像标注的新方法：直接地从图像标注数据集中学习的视觉检测器和语言模型。我们使用的是多示例学习去训练在标题中常见词的视觉检测器，这些常见词包括很多不同的词性包括名词、动词和形容词。单词检测器的输出用作最大熵语言模型的条件输入。这个语言模型从一组超过400,000图像标注中学习，来捕捉单词用法的统计量。我们通过使用句子级的特征和多模态相似性模型来对标题候选者的重新排序，从而获">



  <link rel="alternate" href="/atom.xml" title="Coding With Yali" type="application/atom+xml">



  
  
  <link rel="canonical" href="http://yoursite.com/2019/02/25/论文笔记-From-Captions-to-Visual-Concepts-and-Back/">



<script id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>论文笔记-From Captions to Visual Concepts and Back | Coding With Yali</title>
  












  <noscript>
  <style>
  .use-motion .motion-element,
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-title { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>
	<a href="https://github.com/jiyali" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80" viewbox="0 0 250 250" style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"/><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"/><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"/></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Coding With Yali</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
      
        <p class="site-subtitle">Keep Learning</p>
      
    
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切换导航栏">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">

    
    
    
      
    

    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>首页</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-about">

    
    
    
      
    

    

    <a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i> <br>关于</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">

    
    
    
      
    

    

    <a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i> <br>标签</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">

    
    
    
      
    

    

    <a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i> <br>分类</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
    
      
    

    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>归档</a>

  </li>

      
      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>搜索</a>
        </li>
      
    </ul>
  

  
    

  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/02/25/论文笔记-From-Captions-to-Visual-Concepts-and-Back/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="JiYali">
      <meta itemprop="description" content="研究生期间遇到的问题的记录">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Coding With Yali">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">论文笔记-From Captions to Visual Concepts and Back

              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2019-02-25 14:24:12" itemprop="dateCreated datePublished" datetime="2019-02-25T14:24:12+08:00">2019-02-25</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2019-04-12 18:28:22" itemprop="dateModified" datetime="2019-04-12T18:28:22+08:00">2019-04-12</time>
              
            
          </span>

          

          
            
            
              
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
            
                <span class="post-meta-item-text">评论数：</span>
                <a href="/2019/02/25/论文笔记-From-Captions-to-Visual-Concepts-and-Back/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2019/02/25/论文笔记-From-Captions-to-Visual-Concepts-and-Back/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          
            <span class="post-meta-divider">|</span>
            <span class="post-meta-item-icon">
            <i class="fa fa-eye"></i>
             阅读次数： 
            <span class="busuanzi-value" id="busuanzi_value_page_pv"></span>
            </span>
          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h1 id="摘要"><a href="#摘要" class="headerlink" title="摘要"></a>摘要</h1><p>本文展示了一种自动生成图像标注的新方法：直接地从图像标注数据集中学习的视觉检测器和语言模型。我们使用的是多示例学习去训练在标题中常见词的视觉检测器，这些常见词包括很多不同的词性包括名词、动词和形容词。单词检测器的输出用作最大熵语言模型的条件输入。这个语言模型从一组超过400,000图像标注中学习，来捕捉单词用法的统计量。我们通过使用句子级的特征和多模态相似性模型来对标题候选者的重新排序，从而获得全局语义。</p>
<h1 id="1-前言"><a href="#1-前言" class="headerlink" title="1.前言"></a>1.前言</h1><p>什么时候说明机器理解了图片呢？一个定义是：当它可以生成一个新的标题来概述图片中突出的内容比如图片中出现了什么目标、他们的特征、或者目标之间的关系时，就说机器理解了图片。决定主要内容的不仅需要知道图片内容，而且还需要通过常识推断出场景的哪个方面可能有意思或者很新颖。<br>本文描述了一个从样本中生成图像标注的新方法。我们从图片以及相应的图像标注数据集中训练我们的标题生成器。以前生成图像标题的方法依赖于目标、特征和从单独的手动标注的训练集中学习到的关系探测器。<br>在训练中直接使用标注有两个明显的优势。首先，标题只是包含内在的显著的信息。比如说一个从包含“小狗”这个单词的很多有标题的图片中训练出来的小狗探测器可能偏向于探测突出的小狗，而不是背景中的小狗。图像标注也包括各种各样的单词，包括名词、动词还有形容词。因此，我们需要学习与各种概念相关的探测器。当有些概念，比如说“骑”或者“漂亮”，在理论上可能非常难学习。这些术语可能与特定的视觉形态高度相关（如一个人骑在马上或者日落时在山上。<br>其次，在图像标题上训练语言模型可以获取关于场景中的常识性知识。一个语言模型可以学习到一个人更可能坐在椅子上而不是站在椅子上。这个信息消除了噪声视觉检测的歧义。<br>我们的方法流程如图一所示。首先我们用弱监督学习为一组图像标注中的常用单词构造一个检测器。直接从图像标注中学习是很难的，因为系统并不能利用像对象候选边界框这种在别的数据集中找到的监督信号。很多单词，比如说“拥挤”或者“内部”，甚至没有定义良好的候选边界框。为了克服这个难点，我们使用三个想法。系统使用对象建议生成器查找图像区域。下一步，我们使用预处理的ImageNet卷积神经网络特征对每个区域进行特征化。最后，我们把每个区域的特征映射到可能包含在标注中的一组词汇中去。我们用多示例学习来训练这个映射去确定每个单词信息量最大的图像区域。<br>从可能的词袋产生新的图像标注需要有效的语言模型。在本文中，我们把标注生成看做一个优化问题。这样看来，核心任务就是拿到一套单词检测的分数集，然后找出每个单词都恰好包含一次的最大可能性的句子。我们从一组训练图像标注中训练出一个最大熵语言模型。这种训练通过语言统计学获得关于这个场景的常识性知识。对单词序列进行显示搜索可以有效找出一组可能性高的句子。<br>系统的最后一阶段通过对句子特征进行加权处理重排了这组高似然句子。这些权重通过最小错误率训练学习得到。除了几个普通的句子特征，我们还介绍了一个基于深度多模态相似性模型的新的特征。深度多模态相似性模型学习两个神经网络将图像和文字片段映射到一个公共向量上，这样就能很容易的测量句子和图片之间的相似性。我们论证了，深度多模态相似性模型显著提高了选择句子的质量。<br>为了鉴定我们自动标注的质量，我们用了三个易于计算的指标，以及在“Amazon’s Mechanical Turk”上与人类受试者做了更好/更差/相等的比较。测试是在具有挑战性的”Microsoft COCO“数据集上进行的，这个数据集包含复杂的多个目标的照片。82,783训练图片每一个都有人工注释的标题。为了测定我们句子的质量，我们使用了流行的”BLEU,METEOR还有perplexity (PPLX)”指标。我们惊喜的发现，我们生成的标注在“BLEU”指标上尽然胜过了人类。当人类受试者评估时，受试者发现我们的标注在23%的情况下有着与人类同等质量甚至超过人类。我们也比较了以前在“PLSCAL”语句数据集上的准确性。我们的结果表明，直接在图像标注上同时训练视觉探测器和语言模型和使用全局语义模型来重排标题候选者都是非常有效的。</p>
<h1 id="2-相关工作"><a href="#2-相关工作" class="headerlink" title="2.相关工作"></a>2.相关工作</h1><p>有两个训练良好的自动生成图像标题的方法：检索现有的人工标注的图像标题，生成新的标题。最近基于检索的方法已经使用神经网络将文本和图像映射到一个公共向量中。其他基于检索的方法使用的是预定义的图像特征的相似性指标。Farhadi等人提出将图像和文字作为一个linguistically-motivated（暂时不懂怎么翻译）语义三元组，然后在这个语义三元组中计算相似性。在神经网络的环境下对句子和图像进行了相似的细粒度分析发现对检索的用处不大。<br>基于检索的方法经常返回一个结构良好的人工标注的标题，但是这些标题可能不能很好的描述新目标的组合或者一个新的句子。这种限制导致了大量的工作，首先需要分析图像和图像中检测到的对象，然后生成新的标题。我们把之前在生成过程中使用的语法和语义的限制的研究和当前最先进的技术进行了比较。我们研究了利用最大似然估计结合句法结构生成新句子的”Midge“系统，并将它与选择通过条件随机场预测的最可能的图像标签来填充句子模板的”Baby Talk“系统进行了定性比较。这两个先前的系统使用了相同的测试句子集，使得直接对比两个系统成为了可能。<br>最近，研究人员探索了从图像中引导语言模型的纯粹的统计方法。Kiros等人从图像派生出的文本模型中提取出图像中的偏置特征使用“log-bilinear”模型，Kiros的模型通过采样对标题进行排序和生成。Mao等人探索了图像条件递归神经网络的使用。这两种方法都没有使用明确的出事对象检测步骤。<br>类似于最后两种方法，我们的研究重点为以图像内容为引导的语言生成。不同于这些方法的是，我们通过将CNN应用到图像区域中检测图像中的单词，并将这些单词用MIL进行信息整合。我们还通过直接从标题训练来最小化句子结构的先验假设。最后，与Kiris,Mao相比，我们将生成问题当做一个最优化问题，并寻找最可能的句子。</p>
<h1 id="3-字检测"><a href="#3-字检测" class="headerlink" title="3.字检测"></a>3.字检测</h1><p>我们生成标题流程的第一步是检测出一组最可能是图像标注的一部分的单词。这些单词可能属于任意一种词性，包括动词，名词和形容词。我们规定我们的词汇表V使用1000个训练标题中的常用词汇。这个词汇表包含了训练标题中出现的92%的单词。整个词汇表会在附录中展示出来。</p>
<h2 id="3-1训练单词检测器"><a href="#3-1训练单词检测器" class="headerlink" title="3.1训练单词检测器"></a>3.1训练单词检测器</h2><p>给出了词汇表，我们下一步的目标是从图像中检测单词。当我们不知道与单词对应的图像候选边界时我们不能使用标准监督学习技术。事实上，很多单词比如像“打开”或者“漂亮”的含义并不能很容易的定义它的候选边界框。一个可能的方式是使用图像分类器作为整个图像的输入。在我们展示的第6节里，这将导致性能下降因为很多单词或概念只适用于图像的子区域。相反的，我们用多实例学习的弱监督方法来训练我们的探测器。<br>属于词汇表V的每个单词ω，MIL将候选边界框的“正”“负”袋作为输入集。每个袋相当于一张图像。对于单词ω和图像i，如果单词ω在图像i的描述中时，一个包bi就会将其描述为“正”,反之为负。直观地来说，MIL通过迭代的在“正”包中寻找“正”实例来进行训练，接着用更新“正”标签的方法反复训练探测器。使用Zitnick and Doll´ar的对象建议生成器Edge Boxes 70可以生成每张照片64组候选边界框的计算效率。<br>我们使用noisy-OR版本的MIL，这个版本中包含单词ω的包bi的概率是由词袋中单个实例的概率计算的：<br>这里的（公式）包含单词ω包bi的概率取决于包中每个实例的概率：<br>这里的（公式）是图像i中的候选边界框j对应单词ω的概率。对于每个候选边界框，我们将ImageNet数据放到卷积神经网络的fc6层去训练来计算特征，这些特征已经被证明不仅仅适用于ImageNet的分类任务，而且还适用于各种视觉任务。我们对图像i中的选择框j的fc6的特征Φ(bij)使用了逻辑函数（公式）来计算p(公式）。这里的vω与单词有关系的权重，uω是偏差</p>
<h2 id="3-2对测试图片生成单词"><a href="#3-2对测试图片生成单词" class="headerlink" title="3.2对测试图片生成单词"></a>3.2对测试图片生成单词</h2><p>给定一个新的测试图片i，我们得出n个对象的候选编辑框bij,j∈n。我们对每个候选编辑框使用公式2来计算得分p(公式）。图像标注中出现的单词ω对应的得分p（公式）对应于所有从noist-OR函数计算得到的j的p（公式）的聚合。我们对所有词汇表V中的单词都这么做。请注意所有的词汇探测器早就独立的训练过，因此他们的输出需要校正。为了校正从不同探测器的输出，我们使用图像级可能性p(公式）来计算训练数据的一个扩展子集的精度。我们以全局阙值来评估这个阙值精度。然后输出所有单词V的精度或者和图像级可能性p（公式）结合的更高的精度。<br>公式2向我们展示了一些简单的MIL检测。对于每张图片，我们画出候选边界框。注意，这个方法没有使用任何的边框注释进行训练，但是仍然可以有效的将对象区域化，也可以有效将图像区域和更抽象的概念结合起来。</p>
<h1 id="4-产生语言"><a href="#4-产生语言" class="headerlink" title="4.产生语言"></a>4.产生语言</h1><p>我们将生成过程转换成搜索基于视觉检测到的单词集所能组成的最可能的句子。这个语言模型是整个过程的核心，因为它定义了单词序列的概率分布。注意虽然LM是个概率模型，但是他可以将有意义的信息进行编码，例如“跑步”更可能跟在“马”后面而不是跟在“说话”后面。这些信息可以帮助识别错误的单词检测，并将世界上的常识性知识进行编码。</p>
<h2 id="4-1统计模型"><a href="#4-1统计模型" class="headerlink" title="4.1统计模型"></a>4.1统计模型</h2><p>为了生成图像的候选标题，我们使用基于视觉检测到的单词集的最大熵LM。最大熵LM以前面ω1，ω2……，ωl-1以及前面句子中还没提到的存在于可能性最大的检测单词表Vl中的单词,来估算ωl的概率。以没有使用的单词为条件的动机是鼓励使用所有的单词来避免重复。前十五个最频繁的封闭性词类从集合V中剔除，因为他们几乎在每幅图片中都会被检测到（而且由LM可以任意生成）。注意检测到的单词通常比较嘈杂。因此，当预测句子结束标记时，剩下的单词集可能仍然包含一些检测置信度较高的单词。<br>根据最大熵LM的定义，基于在前面出现过的单词以及后面出现的对象所推测出来的最可能的词可以写作：（公式）<br>这里的“&lt;s（开始标记符）&gt;”表示句子的开始标记，fk和λk分别表示第k个最大熵及这个最大熵的权重。表1总结了我们使用的基本的离散最大熵特征。这些特征来源于我们“baseline”系统。事实证明，使用“得分”特征根据相应的视觉探测器来计算单词的对数似然是有效的。我们也用distant bigram特征和连续空间对数双线性特征做了实验，尽管这些明显改进PPLX，但是他们并没有改善BLEU,METEOR或者human preference，而且空间限制也妨碍了进一步的讨论。<br>为了训练最大熵LM，目标函数基于以相应的的检测对象集中为条件的标题的对数似然（公式）这里的上标(s)表示训练数据集中的句子索引，#(s)表示句子的长度。噪声对比评估(NCE)的技术被用于避免计算式子（3）的分母来加速训练。在生成过程中，我们使用非标准化的NCE似然估计，它比标准的NCE似然估计要有效得多，并且能产生非常相似的输出。然而，我们报告中的所有PPLX数据都是经过彻底的标准化计算的。最大熵特征应用在散列表中就像文献[29]中一样。在我们的实验中，我们使用N-gram从1个单词到4个单词的情况，以及使用了15个对比样本进行了NCE训练。</p>
<h2 id="4-2产生过程"><a href="#4-2产生过程" class="headerlink" title="4.2产生过程"></a>4.2产生过程</h2><p>在产生阶段，我们演示了一个类似于文献[38]中使用的一种从左到右的定向搜索方法。这保持了一堆长度为l的部分假设。在研究的每一步中，每一段在堆栈上长度为l的路径都被加上一段可能的单词，得到的结果为长度l+1的路径被存储起来。前k个长度为l+1的路径被保留下来，剩下的被丢掉。<br>我们定义可能作为延长部分的是“句子结束部分”记作“&lt;/s（结束标记符）&gt;”，100个最频繁的单词被归类到可能被提及到的单词，所有在训练集中出现的单词都被发现跟在假设中的最后一个单词后面。剪枝基于部分路径的可能性。当“&lt;/s结束符号&gt;”产生时，“&lt;/s结束符号&gt;”的完整路径将从堆栈中删除，并将保留为一个完整的句子。这个过程将一直持续到句子长度达到最大长度L。<br>在得到一组完整的句子C后，我们得到了一个如下的M-best列表。给定目标数量为T的被提及的图像属性，C中的序列包含至少T个对象被加到M-best列表中，按对数似然降序排序。如果发现C中有少于M个序列包含至少T个对象，我们将T依次减1直到M个序列被找到。</p>
<h1 id="5-句子重排序"><a href="#5-句子重排序" class="headerlink" title="5.句子重排序"></a>5.句子重排序</h1><p>我们的语言模型生成一套M-best语句。我们最后的一个阶段使用MERT来对句子重新排序。MERT使用在整套句子的基础上计算一个线性组合特征，这些特征比如像句子长度，不能在原始的生成过程中使用。MART模型使用BLEU度量在M-best列表上训练验证集，并且应用测试集的M-best列表。最后，经过重排序的最优的序列被选中作为图片的标注。<br>随着几个标准的特征的使用，我们介绍了一个新的多模态相似模型，将在下面进行讨论。MERT所使用的特征的完整清单见表2.</p>
<h2 id="5-1深度多模态相似性模型"><a href="#5-1深度多模态相似性模型" class="headerlink" title="5.1深度多模态相似性模型"></a>5.1深度多模态相似性模型</h2><p>为了表示图片和文本的全局相似性，我们提出了一个深度多模态相似性模型（DMSM）。DMSM学习到将图像和文本片段映射到公共向量中去的两个神经网络。我们用测量图像和文本相对应的向量的数量积相似性来度量图像和文本的相似性。这个数量积被MERT用来重排序句子。DMSM与基于深度网络的语义模型（DSSM）密切相关，只是将其扩展到多模态设置。DSSM最初被提出是为了对文本搜索查询和文档的语义关联性进行建模，在本工作中进行了扩展，将原始的DSSM查询向量替换为深度卷积神经网络计算的图像向量。<br>DMSM由一对神经网络组成，一个神经网络用于将每个输入进行联合训练后映射到一个共同的语义空间。在训练中，数据由一组图像、标题对组成。训练过程中的最小化的损失函数表示给定相应图像的标题的负对数后验概率。<br>图像模型：我们通过由多个卷积层、最大池化层、相应归一化和全连通层组成的深度卷积神经网络将图像映射到语义向量。这个架构在大规模的图像分类中取得了非常成功的效果，并且学习到的特征被证明可以应用在各种各样的视觉任务中。收到这些成果的激励，为了简化训练，我们没有重新学习我们模型中全部的权重。相反的，我们使用在ILSVRC2012图像分类数据集上训练好的网络初始化了一些图层，并且只在上面训练了前几个全连接层的权重。因此，虽然这个模型非常深（有12层），我们没有在前七层中训练权重值。我们根据验证集的性能交叉验证了其它层的数量。模型的全连接层最后一层的表征是给定图片的语义向量，必须与文本模型的最后一层有相同的大小，才能计算出他们之间的余弦相似度。<br>文本模型：DMSM的文本部分以与原始的DSSM相同的方式将文本段映射到语义向量上。一般来说，当文本段被视为一个可以被表示为使用固定大小的单词计数向量的词袋时，可以是一个完整的标题。根据文献[16]我们将词汇计数向量转变为letter-trigram count vector，使用将上下文相关的字母计数分布来表示一个单词。这种表示的优点是减少了输入层的大小，同时很好的归纳了不常见、没见过的以及拼写错误的单词。这种表示前向传播到一个深度全连接网络，在最后一层生成一个语义向量。<br>对象和训练：我们定义相关性R为图片或者查询和基于他们的表示形式yQ和yD的文字段或者文档Q的余弦相似性得到图像和文本模型：<br>对于给定的文本图像对，我们可以通过公式(6)来计算文本和图像相关的后验概率，这里的γ是使用验证集确定的平滑因子。D表示应该与查询（图像）相比较的一组候选文档（标题）的集合。我们发现将D限制为一个匹配的文件D+并随机的选择固定数字N的不匹配文件D-工作良好，虽然使用噪声控制估计可以进一步的改善结果。因此，对于每一张图像，我们选择一个相关的文字段和N个不相关文字段来计算后验概率。在训练过程中，我们调整模型的参数Λ，使相关字标注和匹配的图像之间的负对数后验概率最小化。（公式7）附加的细节在附录中给出。</p>
<h1 id="6-实验结果"><a href="#6-实验结果" class="headerlink" title="6.实验结果"></a>6.实验结果</h1><p>接下来我们将描述用于测试的数据集，然后评价我们的单次检测的方法和句子生成的实验结果。</p>
<h2 id="6-1数据集"><a href="#6-1数据集" class="headerlink" title="6.1数据集"></a>6.1数据集</h2><p>我们大部分的实验结果就是在MicrosoftCOCO数据集上面的汇报的。这个数据集包含82,783训练图片和40,504张校验图片。由于大部分的照片包含多个对象和中腰的上下文信息，因此这些图片为图像标注创建了一个具有挑战性的测试平台。COCO数据集为每张图片提供了五组人工注释的标题，总共有超过400k的标题。测试的注释是很难得到的，所以我们将验证集分为验证集和测试集。<br>为了与之前的论文进行试验对比，我们还报告了PASCAL语句数据及的实验结果，该数据集包含了来自2008年VOC Challenge的1000张图片，每张图片有6个人工标注的标题。</p>
<h2 id="6-2单词检测"><a href="#6-2单词检测" class="headerlink" title="6.2单词检测"></a>6.2单词检测</h2><p>为了深入理解我们使用MIL进行单次检测的弱监督的方法，我们度量了他=这种方法在单词分类任务上的精确度。注意这是一项极具挑战性的任务，因为概念上相似的单词是单独分类的，比如说单词cat/cats/kitten,或者run/ran/running都对应不同的分类。注意，增加进一步的监督等等，在词元的前提下，无法产生显著的效果。如果一个词至少一次被用在ground truth标注中，他就数与一个图像的正类。<br>不同词性的平均查准率和人为召回的精确度结果如表3。我们发现人们经常在使用哪些单词而存在分歧，而人类因为不同的单词（通过将一个标题中的单词与其他标题对比来衡量）而存在不同的意见（见附录）。当我们考虑更多的标题时，人类的准确率会提高，但是人类的召回率保持相对不变。因此我们测量了提出的算法在人类召回率方面的精度，并且比较了人类的准确率，衡量得到人类和机器的分类能力的相似性。<br>我们报告了两个蓟县。第一个（chance)是对每个单词随机分类的结果。第二个（Classification）是用我们的MIL方法对相同的特征（CNN的fc6层）做一个简单的窗口训练所有的图像分类器得到的结果。<br>如图3显示，MIL NOR方法提高了所有词性的两个基线，证明更好地定位可以帮助预测单词。实际上，我们发现名词和形容词的提高最大，他们通常对应于图像区域中的具体对象。分类和MIL NOR的在词性方面低的结果可能因为视觉信息少而且难以检测，比如说形容词（few，有着1.94的AP），代词（比如：himself，有着1.71的 AP），和介词（比如：before，有0.68的AP）相比之下，拥有较高AP值的单词，要么是视觉信息丰富的（red：AP:62.4，her：AP：34.7）要么与特定对象相关联（polar:AP:78.6,stuffed:AP:60.3）。图2和图3展示了单词定位的定性结果。</p>
<h2 id="6-3标题产生"><a href="#6-3标题产生" class="headerlink" title="6.3标题产生"></a>6.3标题产生</h2><p>我们接下来描述我们的标题生成结果，首先要讨论评估指标。<br>Metrics:句子生成过程使用自动指标和人工研究来度量。我们使用三个不同的自动指标：PPLX,BLEU和METEOR。PPLX测量句子模型的不确定性，对应的是给定语言模型的每个单词的编码需要多少比特。因此PPLX越低表示得分越高。BLEU广泛应用于机器翻译中，用于测量假设和参考或参考集之间的共有的N-gram（从1到4）。METEOR测量一元模型的精度和查全率，扩展精确的单词匹配包括基于WordNet同义词和词根的相似词汇。<br>所有这些自动指标都已知的只大概的和人类的判断有关。因此，我们也做了众包实验进一步的探索我们模型的质量。每个任务都给众包工作者提供一张图片和两组标题。一个是自动生成的标题，另一个是人工标题。工作人员被要求选择图片描述更好的标题，或者选择同等质量的“相同”的标题。在每组实验中，250个Turker被要求对比20组标题对，5个Turkers判断每个标题对。我们使用Crowdflower，它会自动过滤垃圾邮件的发送者。标题的顺序为了避免偏见使用了随机化，我们加入了四个答案显而易见的检查案例，遗漏这些内容的注解者被排除在外。最终的裁判结果大都出自5个Turkers的裁判。在平局的情况下，一半的计数被分布在两个最佳答案。<br>生成结果：表4总结了我们在MC COCO数据集上的标题生成结果。为了进行试验对比，我们提供了几个基线。这包含两个测量数据集复杂性的基线：Unconditioned Generation，在不知道视觉单词检测器的情况下通过对N-gram语言模型生成的句子采样；Shuffled Human，随机选择另一个人从另一幅画中生成的标题。对于这些方法，BLEU和METEOR的评分都非常低，证明MC COCO数据集有很大的多样性和复杂度。<br>我们提供了三个我们的变形算法的结果，Baseline, Baseline+Score, 和 Baseline+Score+DMSM。Baseline使用表1中所有离散的特征训练的ME LMBaseline+Score将单词检测器来给特征评分加入到ME LM。这两种方法都使用了同一组句子特征（包括DMSM评分），这组特征在第5节使用MERT重排标题顺序时描述过。Baseline+Score+DMSM使用了和Baseline+Score同样的ME LM，但是加入了DMSM得分作为特征重排序。如图4表示。带不带单词检测器得分特征的MELX的PPLX大致相同。在ME LM中增加单词检测测器分数的BLEU和METEOR都有改善；并且加入了重排序的DMSM得分进一步提高。令人惊讶的是，BLEU的分数实际上高于人工标注的标题。（21.05%和19.32%）<br>为了更好的理解我们标题的感知质量，我们报告了人们判断自动标题与人工标题的“相同质量”“更好”“相同或更好”的百分比，并从二项分布标准错误中推导出误差线。我们发现，Baseline+Score+DMSM方法生成的标题有23.3%的几率被判断为与人工标题具有相同或者更好的质量，这是对基线结果的显著改善。注意，给定的错误线假设样本是独立的：如果我们使用McNemar配对测试，即在同一组图片上比较三个系统的结果，那么我们会发现添加了DMSM的我们的系统可以使大多数人的投票情况明显改善，P的值为0.024。最终结果如图4所示。<br>为了能够直接的与以前的工作做对比，我们还在PASCAL语句数据集上做了测试，这个数据集在Midge和Baby Talk系统上都有使用。我们发现在Midge系统上的BLEU和METEOR指标都有显著的提高。Baby Talk会产生多个句子的长标题，很难用BLEU和METEOR做比较。然而，为了给定一个对这个领域飞速发展的基本的定性认识，图4展示了我们系统，Midge系统和Baby Talk系统的输出。</p>
<h1 id="7-总结"><a href="#7-总结" class="headerlink" title="7.总结"></a>7.总结</h1><p>本文提出了一种新的生成图像文本标题的系统。我们的系统同时训练图像和对应的人工标题。这个系统从图像区域中提取名词、动词和形容词。然后这些检测到的单词可以引导语言模型生成包括这些检测到的单词的阅读性良好的文本。最后，我们使用一个全局相似性模型，根据图像和标题在公共向量中的总体相似性，对候选标题进行重排序。<br>我们的系统在以BLEU为指标的衡量方法上超过了人工标题的表现。我们系统的标题被Turkers评定为质量等同于人工标题或者在23.3%的情况下优于人工标题。</p>
<h1 id="8-附录"><a href="#8-附录" class="headerlink" title="8.附录"></a>8.附录</h1><p>附录包括以下几个方面：8.1节提供了关于人类对单词预测的一致看法的一个讨论。8.2提供了我们对自动探测单词的额外的分析。8.3和8.4节给出了关于DMSM模型和BLEU评测标准的进一步的细节。</p>
<h2 id="8-1关于单词检测的人类共识"><a href="#8-1关于单词检测的人类共识" class="headerlink" title="8.1关于单词检测的人类共识"></a>8.1关于单词检测的人类共识</h2><p>当我们审查人类对于标题的认识时，我们发现其实在本质上很多相同的东西都有类似的方式。我们可以通过在k+1个人工标题中使用的标注单词以及在前k个引用标题中使用的单词中给定单词ω计算人类精确度和召回率。注意，我们使用了加权的精确度和召回率，每个负类的图像权值为1，每个正类的图像权值等于标题中所含ω的数量。人工精确度（Hp）和人工召回率（Hr）可以通过从K个受试者中有多少个在整个数据集中使用ω去描述给定图像的受试者的数量来计算。<br>我们对一组名词、动词和形容词和所有1000个被考虑进来的单词绘制了Hp-Hr图,如图5。像“大象”这样的动物名词有着很高的召回率，这也就是说，如果“大象”出现在图片中，受试者很有可能去谈论它（直觉上，给定一幅“大象”的图片很稀有，而且没有可以替代“大象”的单词）另一方面，像“BRIGHT”这种形容词使用不一致，因此它的召回率很低。有趣的是，高召回率的单词也有很高的召回率。事实上，所有人类认同的点好像在二维的精确率召回率空间中呈现一维曲线。<br>这个发现促使我们提出一个当受试者使用一个特殊的单词ω描述一张图片时的简单的模型。假设o表示一个对象或者描述视觉概念的单词ω，n表示图像的总数，k表示参考标题的数量。接下来，让q=P（o=1）图像中对象o存在的概率。为了清楚起见，我们将这些定义总结在图6中。我们做了两个简化。首先，我们忽略了图像级别的显著性，而是关注了单词级别的显著性。具体的，我们只对p=P(ω=1|o=1)建模，给定图片中的o受试者使用ω的概率不受图片本身的限制。第二个，我们假设P(ω=1|o=0)=0，也就是受试者不使用ω，除非o在图片中。正如我们即将展示的，即使我们的模型进行了这些简化，也完全可以解释图5中的经验观测值在一个合理的精确度上。<br>基于这些假设，我们可以对只给定p和k的单词ω建立人工精确度Hp和人工召回率Hr的模型。首先，给每个图片k个标题，我们需要计算标题包含单词的期望值cw(1),被模型预测为正的正样本(tp)，被模型预测为正的负样本(fp)。注意在我们的定义里面，每幅图片可以有k个被预测为正的正样本（如果cw=k，也就是所有的k个标题包含的单词ω）但是在模型1中被模型预测为正的负样本（如果k个标题中都没有包含单词ω）。根据k,p和q的期望值为：<br>（公式）<br>上述的ωi次方=1表示ω出现在第i个标题中，注意，我们也假设受o制约的两个受试者之间是独立的。我们可以定义模型的准确率和召回率：<br>（公式）<br>注意，这些表达式只取决于p而跟q无关，有趣的是，由于带有权值的准确率和召回率的使用，给定图片中的o，受试者使用ω的召回率正好等于p。<br>我们假设k=4,改变p来绘制Hp和Hr的图像，得到如图五蓝线所示的曲线（左下）。这条曲线很好的的揭示了所观察的数据，与经验数据的精确度-召回率基本吻合（即使没有那么完美）。我们还可以把标题数量从4个降低，看看经验和预测的准确率和召回率的变化是如何的。图5（右下角）展现出了我们将每张图片的标题数目从4个降到了1个的变化。我们发现人类的一致点保持在一个相同的召回率的值，但是在准确率上却在降低，这与我们的模型预测的一致。同样的，人工召回率对于无限大的受试者来说将趋向于1，这也是合理的，因为受试者只会在图片出现相关的对象时才会使用单词ω（在无限大的受试者的情况下，也依旧会使用单词ω）。<br>事实上，固定的召回率值可以帮助我们恢复p，p是一个受试者可能在给定对象出现的一幅图的描述中会使用单词ω的概率。像“大象”和“网球”这样的名词拥有很大的p值，这是合理的。另一方面，动词和形容词拥有相似的p值，这可以从以下事实中得到证明：(a)主语不太可能来描述对象的属性(b)主语可能用不同的单词(同义词)来描述相同的属性。<br>这些对于人类一致性的分析也促使人们使用不同的指标来衡量系统的表现。我们建议将召回率的准确率作为衡量这一视觉系统的性能指标。假设某一特定词汇的召回率是固定的，而且精度随着注释数目的变化而变化，我们可以看到系统的召回率的准确率和准确率对比，得到视觉系统的性能报告。</p>
<h2 id="8-2词检测分析"><a href="#8-2词检测分析" class="headerlink" title="8.2词检测分析"></a>8.2词检测分析</h2><p>在图6中，我们展示了使用MIL在词频分类上所带来的改进。我们发现频繁出现的单词，MIL给了一个更大的性能提升。对于不太常见的单词，MIL和分类提供了类似的结果。<br>我们系统所使用的的单词列在表7中。</p>
<h2 id="8-3DMSM更多的细节"><a href="#8-3DMSM更多的细节" class="headerlink" title="8.3DMSM更多的细节"></a>8.3DMSM更多的细节</h2><p>在这项任务中，我们使用我们的深度多模态相似性模型(DMSM)去给图像的候选标题按照相关性排序。在这里，我们描述了这个系统训练和验证过程一些细节。<br>DMSM模型将图片和训练集中相对应的标题的相关分数最大化训练，然后对测试图片和生成的标题用语言模型重排序。查询和文档模型（正文中用Λ表示）中的可训练权重是用小批量梯度下降来学习的。我们初步的实验证明，DMDM目标函数可以使用恒定的学习率可靠地进行优化。我们在最初的初步试验中将N和γ固定在40和10上。<br>我们在训练过程中使用验证集平分来选择最佳模型。我们在每次训练验证集之后都测量HBR的值。HBR的计算方法如下：对于每幅图片，我们先计算的最佳秩，最佳秩是任何验证集中的真实标题按照相关性排序ZZ最佳秩的调和平均数。结果表明，调和平均数相比对少数低秩数明暗的ABR的算术平均数更稳定。<br>为了找到性能更好的模型，我们先从最初的的实验数据的子集中识别超参数的有效值。然后我们用不同的架构训练几个模型，每次训练选择验证得分最高的模型。通过这些实验，我们可以观察到网络架构对查询和文档网络的模型性能的影响。自从在ILSVRC2012训练的卷积网络的六层权重层和七层权重层已被证明在不同设置表现良好，我们训练模型也使用了六层或七层预训练固定权重的网络层。在上述研究的基础上，能生成最好的排序性能的最终的模型被用于语言模型生成标题的重排序上。<br>表8总结了我们验证试验的结果。性能最好的架构包含10层用于查询模块的权重层和5层用于文件模型的权重层。查询模型的前七层网络使用了Caffe参考模型并且在训练期间保持不变，所以另一种描述我们的查询模型的办法就是在ILSVRC2012图像分类数据集上训练的网络获得的FC7特性的基础上增加3个全连接层。<br>值得注意的是，总的来说我们发现当使用FC7特征比使用FC6特征有更好的性能。由于这些特征来自ImageNet模型中最接近softmax分类层的层，因此我们可以说拥有更高的区别性的特征对我们特定的实验环境有益。<br>从结果可以明显看出，网络深度对于查询和文件模型都有明显的优势。这对于查询模型来说并不惊奇，网络的深度已被证明对许多计算机视觉任务至关重要。然而，我们看到在这里发现的最佳文本模型与过去的像web搜索模型形成了明显的对比，查询问题和web文档标题是匹配的而图片和文本段不匹配。与自然图片的描述相比搜索查询和web页面标题通常都很短，并且他们的语义表述通常不纠缠在一起。因此我们发现将文档模型的深度增加到5层或6层有助于提高性能。尽管我们的文档目前没有考虑标题中单词的相对顺序，但是它相当好不需要使用显式的依存关系语法就能捕获它们之间的关系。这与最近的神经网络自然语言处理领域的研究一致。</p>
<h2 id="8-4BLEU"><a href="#8-4BLEU" class="headerlink" title="8.4BLEU"></a>8.4BLEU</h2><p>BLEU最初由Papineni等人为了测量机器翻译输出的质量而提出。BLEU-4平分在机器翻译领域和本文中都是常用的。计算方法为（公式）</p>

      
    </div>

    

    
    
    

    

    
      
    
    
      <div>
        <div id="reward-container">
  <div>would you buy me a coffee☕~</div>
  <button id="reward-button" disable="enable" onclick="var qr = document.getElementById(&quot;qr&quot;); qr.style.display = (qr.style.display === 'none') ? 'block' : 'none';">
    打赏
  </button>
  <div id="qr" style="display: none;">

    
      
      
        
      
      <div style="display: inline-block">
        <img src="/images/wechat.png" alt="JiYali 微信支付">
        <p>微信支付</p>
      </div>
    

  </div>
</div>

      </div>
    

    
      <div>
        




  



<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者： </strong>JiYali</li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    
    <a href="http://yoursite.com/2019/02/25/论文笔记-From-Captions-to-Visual-Concepts-and-Back/" title="论文笔记-From Captions to Visual Concepts and Back">http://yoursite.com/2019/02/25/论文笔记-From-Captions-to-Visual-Concepts-and-Back/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fa fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！</li>
</ul>

      </div>
    

    <footer class="post-footer">
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2019/02/23/2019-to-do-list/" rel="next" title="2019 to do list">
                <i class="fa fa-chevron-left"></i> 2019 to do list
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2019/03/06/论文笔记-Show-and-Tell-A-Neural-Image-Caption-Generator/" rel="prev" title="论文笔记-Show and Tell:A Neural Image Caption Generator">
                论文笔记-Show and Tell:A Neural Image Caption Generator <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>


  </div>


          </div>
          

  
    <div class="comments" id="comments">
    </div>

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">JiYali</p>
              <div class="site-description motion-element" itemprop="description">研究生期间遇到的问题的记录</div>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">5</span>
                    <span class="site-state-item-name">日志</span>
                  </a>
                </div>
              

              

              
            </nav>
          

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          

          
            <div class="links-of-author motion-element">
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="https://github.com/jiyali" title="GitHub &rarr; https://github.com/jiyali" rel="noopener" target="_blank"><i class="fa fa-fw fa-globe"></i>GitHub</a>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="https://weibo.com/3877347556/profile?rightmod=1&wvr=6&mod=personinfo" title="微博 &rarr; https://weibo.com/3877347556/profile?rightmod=1&wvr=6&mod=personinfo" rel="noopener" target="_blank"><i class="fa fa-fw fa-globe"></i>微博</a>
                </span>
              
            </div>
          

          

          
          

          
            
          
          

        </div>
      </div>

      
      <!--noindex-->
        <div class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
            
            
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#摘要"><span class="nav-number">1.</span> <span class="nav-text">摘要</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#1-前言"><span class="nav-number">2.</span> <span class="nav-text">1.前言</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#2-相关工作"><span class="nav-number">3.</span> <span class="nav-text">2.相关工作</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#3-字检测"><span class="nav-number">4.</span> <span class="nav-text">3.字检测</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#3-1训练单词检测器"><span class="nav-number">4.1.</span> <span class="nav-text">3.1训练单词检测器</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-2对测试图片生成单词"><span class="nav-number">4.2.</span> <span class="nav-text">3.2对测试图片生成单词</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#4-产生语言"><span class="nav-number">5.</span> <span class="nav-text">4.产生语言</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#4-1统计模型"><span class="nav-number">5.1.</span> <span class="nav-text">4.1统计模型</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-2产生过程"><span class="nav-number">5.2.</span> <span class="nav-text">4.2产生过程</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#5-句子重排序"><span class="nav-number">6.</span> <span class="nav-text">5.句子重排序</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#5-1深度多模态相似性模型"><span class="nav-number">6.1.</span> <span class="nav-text">5.1深度多模态相似性模型</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#6-实验结果"><span class="nav-number">7.</span> <span class="nav-text">6.实验结果</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#6-1数据集"><span class="nav-number">7.1.</span> <span class="nav-text">6.1数据集</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-2单词检测"><span class="nav-number">7.2.</span> <span class="nav-text">6.2单词检测</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-3标题产生"><span class="nav-number">7.3.</span> <span class="nav-text">6.3标题产生</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#7-总结"><span class="nav-number">8.</span> <span class="nav-text">7.总结</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#8-附录"><span class="nav-number">9.</span> <span class="nav-text">8.附录</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#8-1关于单词检测的人类共识"><span class="nav-number">9.1.</span> <span class="nav-text">8.1关于单词检测的人类共识</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#8-2词检测分析"><span class="nav-number">9.2.</span> <span class="nav-text">8.2词检测分析</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#8-3DMSM更多的细节"><span class="nav-number">9.3.</span> <span class="nav-text">8.3DMSM更多的细节</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#8-4BLEU"><span class="nav-number">9.4.</span> <span class="nav-text">8.4BLEU</span></a></li></ol></li></ol></div>
            

          </div>
        </div>
      <!--/noindex-->
      

      

    </div>
  </aside>
  


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love" id="animate">
    <i class="fa fa-fas fa-heartbeat"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">JiYali</span>

  

  
</div>


  <!--<div class="powered-by">由 <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> 强力驱动 v3.8.0</div>





  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> v7.1.0</div>
-->




        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="post-meta-item-icon">
      <i class="fa fa-user"></i>
    </span>
    <span class="site-uv" title="总访客量">
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
    </span>
  

  
    <span class="post-meta-divider">|</span>
  

  
    <span class="post-meta-item-icon">
      <i class="fa fa-eye"></i>
    </span>
    <span class="site-pv" title="总访问量">
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
    </span>
  
</div>









        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
          <span id="scrollpercent"><span>0</span>%</span>
        
      </div>
    

    

    

    
  </div>

  

<script>
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  <script src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>


  


  <script src="/js/utils.js?v=7.1.0"></script>

  <script src="/js/motion.js?v=7.1.0"></script>



  
  


  <script src="/js/schemes/muse.js?v=7.1.0"></script>



  
  <script src="/js/scrollspy.js?v=7.1.0"></script>
<script src="/js/post-details.js?v=7.1.0"></script>



  


  <script src="/js/next-boot.js?v=7.1.0"></script>


  

  

  

  
  

<script src="//cdn1.lncld.net/static/js/3.11.1/av-min.js"></script>



<script src="//unpkg.com/valine/dist/Valine.min.js"></script>

<script>
  var GUEST = ['nick', 'mail', 'link'];
  var guest = 'nick,mail,link';
  guest = guest.split(',').filter(function(item) {
    return GUEST.indexOf(item) > -1;
  });
  new Valine({
    el: '#comments',
    verify: true,
    notify: true,
    appId: 'bEEICTEdKgYSitT9FQYHTxh7-gzGzoHsz',
    appKey: 'DM9WVs6DaBxGuBXs2flCCS0v',
    placeholder: 'ヾﾉ≧∀≦)o来啊，快活啊!',
    avatar: 'mm',
    meta: guest,
    pageSize: '10' || 10,
    visitor: false,
    lang: '' || 'zh-cn'
  });
</script>




  


  
  <script>
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url).replace(/\/{2,}/g, '/');
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x"></i></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x"></i></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  

  

  

  

  

  

  

  

  

  

  

<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/koharu.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"log":false});</script></body>
</html>
